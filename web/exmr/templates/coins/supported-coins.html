{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}
    {% load i18n %}
    <section>
       <div class="merchant-tools merchant-one coin-payment-head">
            <div class="merchant-tools merchant-one">
                <div class=" container merchant-box">{% trans 'SUPPORTED COINS' %}
                </div>
                <div class="container subline-p merchant-toolp">
                    <p>{% trans 'Instant get crypto payments checkout with easy to use cart plugin, advanced, invoice buillder and API for custom integration' %}
                    </p>
                </div>

            </div>

        </div>
        <div class="dashboard-bg">
            <div class="container">
                <div class="dashboard-wrapper">
                    <div class="dasboard-head">
                        <div class="supportcoin-check-wrap">
                            <ul>
                                {% for coin_type in coin_types %}

                                <li class=" col-sm-3 check-box-box"><div class="checkbox check-box-line">
                                    <input id="checkbox1" name="type" type="radio" value={{ coin_type.0 }} class="mt0" {% ifequal selected_coin_type  coin_type.0 %} checked{% endifequal %}>
                                    <label for="checkbox1" class="mt0" >
                                        {{ coin_type.1 }}
                                    </label>
                                </div>
                                </li>
                                {% endfor %}

                            </ul>
                        </div>
                    </div>
                    <div class="account-setting-wrap coin-support-main-wrap">
                        <fieldset class="setting-form form-settings">
                            <table class="table support-table">
                                <thead>
                                <tr>
                                    <th>{% trans 'COIN NAME' %}</th>
                                    <th>{% trans 'COD' %}</th>
                                    <th>{% trans 'FEE' %}
                                        <sub class="sub-number">1</sub>
                                    </th>
                                    <th>{% trans 'CONFIRMS' %}</th>
                                    <th>{% trans 'TO BTC' %}
                                        <sub class="sub-number">2</sub>
                                    </th>
                                    <th>{% trans 'EXPLORE' %}</th>

                                </tr>
                                </thead>
                                <tbody>

                                {% for coin in coins %}
                                <tr>
                                    <td>
                                        {% if coin.coin.image %}
                                        <img class="coin-icon-support" src={{ coin.image.url }}>
                                        {% endif %}
                                        <span class="coin-name">{% if coin.coin_url %}<a href="{{ coin.coin_url }}">{{ coin.coin_name }}</a>{% else %}{{ coin.coin_name }}{% endif %}</span>
                                    </td>
                                    <td>{{ coin.code }}</td>
                                    <td>{{ coin.fee_percentage }}%</td>
                                    <td>{{ coin.confirms }}</td>
                                    <td>{{ coin.to_btc }}</td>
                                    <td>
                                        {% if coin.can_convert %}
                                        <button type="button" class="btn btn-primary btn-support-convert" data-coin-id="{{ coin.code }}" data-toggle="modal" data-coin-id="" data-target="#myModal">
                                            <img class="arrow-covertet-icon"  src={% static 'images/arrows.svg' %}> Converter</button>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}

                                </tbody>
                            </table>
                        </fieldset>
                    </div>

                </div>
            </div>
        </div>

    </section>
    <!-- Modal -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content popup-top">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">{% trans 'Convert Coin' %}
{#                        <img  class="coin-icon-support"  src={% static 'images/BTC-SUPPORT-COIN.png' %}> #}
{#                        {% trans 'BITCOIN' %}#}
                    </h4>
                </div>
                <div class="modal-body">
                    {% for coin in coins %}
                    <button id="coin_{{ coin.code }}" class="conver-btn-coin" type="button">
                        {% if coin.image %}
                        <img  class="coin-icon-support coin-replace"
                              src={{ coin.image.url }}>
                        {% endif %}
                        <span class="coin-name">
                            {{ coin.coin_name }}
                        </span>
                    </button>
                    {% endfor %}

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">{% trans 'Close' %}</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
    <script>
    var selected_coin;
    $(':radio[name="type"]').change(function() {
        window.location.replace('{% url 'coins:supported_coins' %}?type='+$(this).val());
    });

    $('.btn-support-convert').on('click', function () {
        $('.conver-btn-coin').show();
        $('#coin_'+$(this).data('coin-id')).hide();
        selected_coin = $(this).data('coin-id');
    });

    $('.conver-btn-coin').on('click', function () {
        $('.conver-btn-coin').show();
        var from_coin = $(this).attr('id').split('_')[1];
        var url_mask = "{% url 'coins:coin_conversion' from=12345 to=11 %}".replace('/12345/11/', '/'+from_coin+'/'+selected_coin+'/');
        window.location.replace(url_mask);
    })

    </script>
{% endblock %}
